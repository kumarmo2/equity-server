# Transactions



## Tables

### Transactions.
- id(autogenerated, primary key)
- tradeId(int)
- version(int)
- securityCode(text)
- quantity(double)
- tradeOperationType(int)
- tradeType(int)

### Position
- id(autogenerated, primary key)
- securityCode(text)
- quantity(double)


## Put Request
- tradeId
- securityCode
- Quantity
- tradeOperation(insert, update, cancel)
- tradeType (buy/sell)

### Logic
- this request will first insert in the "Transactions table"
    - transactionId will be autogenerated, but for a given trade, we will need to generate the versionId.
# - Once this is inserted, then we can do post-processing 
-  fetch every existing transaction for the "securityCode".  
    - initialize the quantity to 0.
    - (TODO)because the "events" can come in different orders, the "version" of an event can be updated.
        - 
    - group them by "tradeId".
        - if any version of the trade is "cancelled", then we can early return and set the quantity to 0 for that trade.
        - find the "insert" version of the trade, 
            - (This is have taken the liberty to assume as it was not specified): If not found than set the quantity to 0 for that trade and early return.
            - if found, then set to +/- quantity based upon tradeType.
        - process rest of the "update" events and overwrite the quantity for that trade.
    - "Sum" all the quantities of a trade for the given "securityCode".
    - "upsert" in the positions table the quantity for the "securityCode".
    
    


## Get
- no request params. should show all the position values for the securityCodes
